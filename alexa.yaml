  intents:
    WhereAreWeIntent:
      speech:
        type: plaintext
        text: >
          {%- if is_state('input_boolean.alanhome', 'on') and
                 is_state('input_boolean.rayhome', 'on') -%}
            You are both home, you silly goose.
          {%- else -%}
            Ray is at {{ states.device_tracker.raywtse_note4.state.replace('_', ' ') }}.
            and Alan is at {{ states.device_tracker.alandtse_nexus5.state.replace('_', ' ') }}.
          {% endif %}
      card:
        type: simple
        title: Where are We?
        content: Ask Home Assistant about where everyone is
    CheckGarageIntent:
      speech:
        type: plaintext
        text: >
           The garage door is {{ states.cover.garage_door_opener.state }}. 
      card:
        type: simple
        title: Is the garage door open?
        content: Ask Home Assistant to check the garage door 
    CheckAlarmIntent:
      speech:
        type: plaintext
        text: >
           The alarm is {{ states.alarm_control_panel.simplisafe.state }}. 
      card:
        type: simple
        title: Is the alarm on?
        content: Ask Home Assistant to check alarm
    OpenGarageIntent:
      action:
        service: cover.open_cover
        entity_id: cover.garage_door_opener
      speech:
        type: plaintext
        text: Opening the garage now.
      card:
        type: simple
        title: Open Garage Door 
        content: Ask Home Assistant to open the garage door
    LocateIntent:
      action:
        - service: logbook.log
          data_template:
            message: The location of {{ User }} has been queried via Alexa.
      speech:
        type: plaintext
        text: >
          {%- if User == "Alan" and is_state('input_boolean.alanhome', 'off') -%}
            Alan is at {{ states.device_tracker.alandtse_nexus5.state.replace('_', ' ') }} and is {{ states("sensor.alan_to_home") }} minutes away.
          {%- elif User == "Alan" -%}
            Alan is at {{ states.device_tracker.alandtse_nexus5.state.replace('_', ' ') }}.
          {%- elif User == "Ray" and is_state('input_boolean.rayhome', 'off') -%}
            Ray is at {{ states.device_tracker.raywtse_note4.state.replace('_', ' ') }} and is {{states("sensor.ray_to_home") }} minutes away.
          {%- elif User == "Ray" -%}
            Ray is at {{ states.device_tracker.raywtse_note4.state.replace('_', ' ') }}.
          {%- else -%}
            I am sorry, I do not know where {{ User }} is. 
          {%- endif -%}
      card:
        type: simple
        title: Location queried
        content: Ask Home Assistant about user location
    HowIsTheTrafficIntent:
      speech:
        type: plaintext
        text: >
          Your commute to work is about {{ states.sensor.morning_commute.state }} minutes and back home is {{ states.sensor.evening_commute.state }} minutes.
      card:
        type: simple
        title: Traffic Conditions
        content: Ask Home Assistant about current traffic conditions
    RunScriptIntent:
      action:
        service: script.turn_on
        data_template:
          entity_id: script.{{ Script | replace(" ", "_") }}
      speech:
        type: plaintext
        text: !include alexa_confirm.yaml
      card:
        type: simple
        title: Run Script
        content: Ask Home Assistant to run Script.
