#################################################################
## Scripts
#################################################################

  abodeaway:
    alias: 'Abode Arm'
    sequence:
      - service: input_select.select_option
        data:
          entity_id: input_select.abodestatus
          option: 'away'
      - service: notify.pushbullet
        data:
          message: "Arming alarm for away"
      - service: script.turn_on
        data:
          entity_id: script.arm_away
#      - service: shell_command.armaway
#      - service: ifttt.trigger
#        data: {"event":"AbodeAway", "value1":"Arm Abode"}
      - service: climate.set_away_mode
        data:
          entity_id: climate.downstairs
          away_mode: 'True'
      - service: climate.set_away_mode
        data:
          entity_id: climate.upstairs
          away_mode: 'True'
      - service: homeassistant.turn_off
        entity_id: light.great_room_lights

  abodehome:
    alias: 'Abode Home'
    sequence:
      - service: input_select.select_option
        data:
          entity_id: input_select.abodestatus
          option: 'home'
#      - service: shell_command.disarm
      - service: notify.pushbullet
        data:
          message: "Arming alarm for home"
      - service: script.turn_on
        data:
          entity_id: script.arm_home
#      - service: shell_command.arm
#      - service: ifttt.trigger
#        data: {"event":"AbodeHome", "value1":"Abode Home"}

  abodestandby:
    alias: 'Abode Standby'
    sequence:
      - service: input_select.select_option
        data:
          entity_id: input_select.abodestatus
          option: 'standby'
      - service: notify.pushbullet
        data:
          message: "Disarming alarm"
      - service: script.turn_on
        data:
          entity_id: script.disarm
#      - service: shell_command.disarm
#      - service: ifttt.trigger
#        data: {"event":"AbodeStandby", "value1":"Abode Standby"}
#      - service: climate.set_away_mode
#        data:
#          entity_id: climate.upstairs
#          away_mode: 'False'
      - service: climate.set_away_mode
        data:
          entity_id: climate.downstairs
          away_mode: 'False'
      - service_template: >
          {% if is_state('sun.sun', 'below_horizon') %}
            homeassistant.turn_on
          {% else %}
            homeassistant.turn_off
          {% endif %}
        entity_id: light.great_room_lights
#      - service: light.turn_off
#        entity_id: group.living_room_lights

  notificationgaragedoor:
    alias: 'Garage Door Open'
    sequence:
      - service: notify.pushbullet
        data:
          message: 'Garage door is open, please check!'
      - service: notify.ecobee
        data:
          message: 'Garage door is open, please check!'
      - service: tts.google_say
        data:
          entity_id: media_player.tts_bluetooth_speaker
          message: 'Garage door is open, please check!'

  notificationleavework:
    alias: 'Leave for Work'
    sequence:
      - service: notify.pushbullet
        data:
          message: 'Traffic has cleared, you can leave for work.'

  arm_home:
    alias: 'Arm Home'
    sequence:
      - service: shell_command.disarm
      - delay: 00:00:01
      - service: shell_command.arm
      - delay: 00:00:30
      - service: script.turn_on
        data:
          entity_id: script.checkarmhome
  checkarmhome:
    alias: 'Check Arm home'
    sequence:
      - condition: state
        entity_id: 'alarm_control_panel.simplisafe'
        state: 'disarmed'
      - service: script.turn_on
        data:
          entity_id: script.arm_home
  arm_away:
    alias: 'Arm Away'
    sequence:
      - service: shell_command.disarm
      - delay: 00:00:01
      - service: shell_command.armaway
      - delay: 00:00:30
      - service: script.turn_on
        data:
          entity_id: script.checkarmaway
  checkarmaway:
    alias: 'Check Arm Away'
    sequence:
      - condition: state
        entity_id: 'alarm_control_panel.simplisafe'
        state: 'disarmed'
      - service: script.turn_on
        data:
          entity_id: script.arm_away

  disarm:
    alias: 'Disarm'
    sequence:
      - service: shell_command.disarm
      - delay: 00:00:30
      - service: script.turn_on
        data:
          entity_id: script.checkdisarm
  checkdisarm:
    alias: 'Check Disarm'
    sequence:
      - condition: or
        conditions:
          - condition: state
            entity_id: 'alarm_control_panel.simplisafe'
            state: 'armed_home'
          - condition: state
            entity_id: 'alarm_control_panel.simplisafe'
            state: 'armed_away'
      - service: script.turn_on
        data:
          entity_id: script.disarm
  
  opengarage:
    alias: 'Open Garage'
    sequence:
      - service: cover.open_cover
        entity_id: cover.garage_door_opener
      - service: script.turn_on
        data:
          entity_id: script.checkdisarm

  owntracks_update:
    sequence:
      - service: mqtt.publish
        data:
          topic: owntracks/alandtse/Nexus5/cmd 
          payload: '{"_type":"cmd","action":"reportLocation"}"'
      - service: mqtt.publish
        data:
          topic: owntracks/raywtse/Note4/cmd 
          payload: '{"_type":"cmd","action":"reportLocation"}"'
  recordgate:
    alias: 'Record Gate'
    sequence:
      - service: shell_command.recordgate

